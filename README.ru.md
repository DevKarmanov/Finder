# Обзор

Платформа позволяет пользователям создавать объявления о поиске команд для своих проектов или присоединяться к уже существующим. Цель платформы - помочь пользователям найти возможность получить опыт командной работы и повысить свои навыки.

Каждый может участвовать и заимствовать код, но важно соблюдать условия лицензии.

<details>
  <summary><strong>В настоящее время реализовано:</strong></summary>

  ### Управление объявлениями
  - **Создание, редактирование и удаление объявлений.**
  - **Просмотр списка объявлений.**
  - **Добавление или удаление объявлений из избранного.**
  - **Интеграция с поисковой системой Elasticsearch.**

  ### Управление комментариями и ответами
  - **Создание, редактирование и удаление комментариев к объявлениям.**
  - **Добавление и управление ответными комментариями.**

  ### Управление профилем пользователя и аккаунтом
  - **Регистрация и вход пользователя.**
  - **Редактирование информации профиля пользователя.**
  - **Обновление аватара профиля.**
  - **Просмотр профиля пользователя.**
  - **Удаление учетной записи пользователя.**

  ### Контроль доступа и безопасность
  - **Проверка токена доступа.**
  - **Выдача нового токена доступа с использованием обновляющего токена.**

  ### Инструменты администратора и управление жалобами
  - **Подавать жалобы на пользователей или объявления.**
    - **Привилегии администратора включают:**
      - Просмотр списка жалоб.
      - Удаление жалоб.
  - **Модерация пользователей:**
    - Банить или разбанивать пользователей.
    - Корректировать роли пользователей (повышение или понижение).  
</details>

---
### Настройки

| Окружение            | Описание                                                                                                   |
|:---------------------:|:---------------------------------------------------------------------------------------------------------:|
| X_API_KEY             | Ключ для подключения внутренних API друг к другу, который не должен быть доступен извне                   |
| ELASTIC_PASSWORD      | Пароль от пользователя elasticSearch                                                                      |
| POSTGRES_DB           | Название вашей базы данных                                                                                |
| POSTGRES_USER         | Логин от вашего postgres                                                                                  |
| POSTGRES_PASSWORD     | Пароль для вашего postgres                                                                                |
| MINIO_ROOT_USER       | Логин от minIO                                                                                            |
| MINIO_ROOT_PASSWORD   | Пароль для вашего minIO                                                                                   |

---

# Микросервисы

### Микросервис объявлений
Управляет объявлениями и их содержимым, включая жалобы пользователей.
<details>
  <summary><strong>Эндпоинты:</strong></summary>

#### **1. GET** `/card/{id}/get`

- **Описание**: Получить объявление по его уникальному идентификатору.
- **Параметр пути**:
    - `id` — Уникальный идентификатор объявления.
- **Заголовок запроса**:
    - `Authorization` — JWT токен для аутентификации.
- **Пример ответа**:
    ```json
    {
       "id": 15,
       "title": "2-я карточка",
       "text": "описание 2-й карточки",
       "createTime": "2024-10-11T11:13:21.96246",
       "images": [
           {
               "id": 55,
               "imageBucket": "images",
               "imageName": "image-name1.jpg"
           },
           {
               "id": 50,
               "imageBucket": "images",
               "imageName": "image-name2.jpg"
           },
           {
               "id": 51,
               "imageBucket": "images",
               "imageName": "image-name3.jpg"
           },
           {
               "id": 52,
               "imageBucket": "images",
               "imageName": "image-name4.jpg"
           },
           {
               "id": 53,
               "imageBucket": "images",
               "imageName": "image-name5.jpg"
           }
       ],
       "authorName": "johndoe123456789"
   }
    ```
    
- **Коды ответа**:
    - `200 OK`: Успешное получение.
    - `404 Not Found`: Если объявление с указанным идентификатором не существует.

---

#### **2. GET** `/card/getAll/{pageNumber}/{limit}`

- **Описание**: Получить все объявления с поддержкой пагинации.
- **Параметры пути**:
    - `pageNumber` — Номер страницы для получения.
    - `limit` — Количество объявлений на странице.
- **Заголовок запроса**:
    - `Authorization` — JWT токен для аутентификации.
- **Пример ответа**:
    ```json
    {
       "cards": [
           {
               "id": 15,
               "title": "2-я карточка",
               "text": "описание 2-й карточки",
               "createTime": "2024-10-11T11:13:21.96246",
               "images": [
                   {
                       "id": 55,
                       "imageBucket": "images",
                       "imageName": "image-name1.jpg"
                   },
                   {
                       "id": 50,
                       "imageBucket": "images",
                       "imageName": "image-name2.jpg"
                   },
                   {
                       "id": 51,
                       "imageBucket": "images",
                       "imageName": "image-name3.jpg"
                   },
                   {
                       "id": 52,
                       "imageBucket": "images",
                       "imageName": "image-name4.jpg"
                   },
                   {
                       "id": 53,
                       "imageBucket": "images",
                       "imageName": "image-name5.jpg"
                   }
               ],
               "authorName": "johndoe123456789"
           }
       ],
       "last": true,
       "totalPages": 1,
       "totalElements": 1,
       "first": true,
       "numberOfElements": 1
  }
  ```
    
- **Коды ответа**:
    - `200 OK`: Успешное получение.
    - `400 Bad Request`: Если предоставлены некорректные данные.

---

#### **3. GET** `/complaint/get`

- **Описание**: Получить список жалоб.
- **Параметры запроса**:
    - `limit` (опционально, по умолчанию: 5) — Максимальное количество жалоб для возврата.
    - `page` (опционально, по умолчанию: 0) — Номер страницы для постраничной навигации.
    - `complaintType` (опционально, по умолчанию: `all`) — Тип жалобы для фильтрации:
        - `card` — Получить жалобы, связанные с объявлениями.
        - `user` — Получить жалобы, связанные с пользователями.
        - Если не указано или недействительно, будут возвращены все жалобы.
- **Заголовок запроса**:
    - `Authorization` — JWT токен для аутентификации.
- **Пример ответа**:
    ```json
    {
	    "complaints": [
	        {
	            "type": "card",
	            "complaintId": 6,
	            "reason": "reason",
	            "complaintAuthorName": "venik6",
	            "cardId": 2
	        },
	        {
	            "type": "user",
	            "complaintId": 7,
	            "reason": "reason",
	            "complaintAuthorName": "venik6",
	            "userName": "venik3"
	        }
	    ],
	    "last": false,
	    "totalPages": 2,
	    "totalElements": 3,
	    "first": true,
	    "numberOfElements": 2
    }
    ```

- **Коды ответа**:
    - `200 OK`: Успешно получен список жалоб.
    - `400 Bad Request`: Если токен отсутствует или недействителен.
    - `403 Forbidden`: Если у пользователя недостаточно прав для просмотра жалоб.
    - `500 Internal Server Error`: Если произошла ошибка во время процесса получения.

---

#### **4. POST** `/card/add`

- **Описание**: Добавить новое объявление.
- **Тело запроса**:
    - `cardDto` — Содержит детали об объявлении (название, текст).
    - `files` — Список изображений для загрузки и прикрепления к объявлению.
- **Заголовок запроса**:
    - `Authorization` — JWT токен для аутентификации.
- **Ответ**:
    - `200 OK`: Успешно создано новое объявление.
    - `400 Bad Request`: Если входные данные недействительны (например, слишком много изображений, отсутствуют обязательные поля).
    - `500 Internal Server Error`: Если возникла проблема во время процесса создания объявления.

---

#### **5. POST** `/complaint/create`

- **Описание**: Подать жалобу на конкретного пользователя или объявление.
- **Тело запроса**:
    - `complaintDto` — Детали жалобы.
- **Заголовок запроса**:
    - `Authorization` — JWT токен для аутентификации.
- **Поддерживаемые типы**: `multipart/form-data`
- **Тело запроса**:
```json
{
    "targetType":"USER или CARD", 
    "reason": "reason",
    "complaintTargetId":"Если вы жалуетесь на пользователя, введите ID пользователя. Если вы жалуетесь на объявление, введите ID объявления."
}
```   
- **Коды ответа**:
    - `200 OK`: Жалоба успешно подана.
    - `400 Bad Request`: Если токен отсутствует или недействителен.
    - `404 Not Found`: Если пользователь или карточка, на которые подана жалоба, не найдены.

---
